<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect to Notion - notion-cli</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            background: #ffffff;
            color: #37352f;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .logo-wrapper {
            text-align: center;
            margin-bottom: 2rem;
        }

        .logo { width: 48px; height: 48px; }

        h1 {
            font-size: 1.25rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        .subtitle {
            text-align: center;
            color: #6b6b6b;
            font-size: 0.875rem;
            margin-bottom: 2rem;
        }

        .oauth-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            width: 100%;
            padding: 1rem 1.25rem;
            background: #191919;
            color: #ffffff;
            border: 1px solid #333333;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            transition: background 0.15s, border-color 0.15s;
        }

        .oauth-btn:hover {
            background: #2a2a2a;
            border-color: #444444;
        }

        .oauth-btn .notion-logo { width: 22px; height: 22px; flex-shrink: 0; }

        .divider {
            display: flex;
            align-items: center;
            margin: 1.75rem 0;
            color: #9b9a97;
            font-size: 0.8125rem;
        }

        .divider::before,
        .divider::after {
            content: "";
            flex: 1;
            height: 1px;
            background: #e3e2e0;
        }

        .divider span { padding: 0 1rem; }

        .token-section h2 {
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #37352f;
        }

        .token-section p {
            font-size: 0.8125rem;
            color: #6b6b6b;
            margin-bottom: 0.75rem;
            line-height: 1.5;
        }

        .token-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #e3e2e0;
            border-radius: 6px;
            font-size: 0.875rem;
            font-family: "SFMono-Regular", Menlo, Consolas, monospace;
            margin-bottom: 0.75rem;
            transition: border-color 0.15s;
        }

        .token-input:focus {
            outline: none;
            border-color: #000000;
        }

        .token-input::placeholder { color: #9b9a97; }

        .token-btn {
            width: 100%;
            padding: 0.75rem 1rem;
            background: #ffffff;
            color: #37352f;
            border: 1px solid #e3e2e0;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.15s, border-color 0.15s;
        }

        .token-btn:hover {
            background: #f7f6f3;
            border-color: #d4d3d0;
        }

        .token-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .error {
            color: #e03e3e;
            font-size: 0.8125rem;
            margin-top: 0.5rem;
            display: none;
        }

        .error.show { display: block; }

        .help-link {
            display: block;
            text-align: center;
            margin-top: 2rem;
            font-size: 0.8125rem;
            color: #6b6b6b;
        }

        .help-link a {
            color: #37352f;
            text-decoration: underline;
            text-underline-offset: 2px;
        }

        .help-link a:hover { color: #000000; }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo-wrapper">
            <svg class="logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <path d="M6.017 4.313l55.333 -4.087c6.797 -0.583 8.543 -0.19 12.817 2.917l17.663 12.443c2.913 2.14 3.883 2.723 3.883 5.053v68.243c0 4.277 -1.553 6.807 -6.99 7.193L24.467 99.967c-4.08 0.193 -6.023 -0.39 -8.16 -3.113L3.3 79.94c-2.333 -3.113 -3.3 -5.443 -3.3 -8.167V11.113c0 -3.497 1.553 -6.413 6.017 -6.8z" fill="#fff"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M61.35 0.227l-55.333 4.087C1.553 4.7 0 7.617 0 11.113v60.66c0 2.723 0.967 5.053 3.3 8.167l13.007 16.913c2.137 2.723 4.08 3.307 8.16 3.113l64.257 -3.89c5.433 -0.387 6.99 -2.917 6.99 -7.193V20.64c0 -2.21 -0.873 -2.847 -3.443 -4.733L74.167 3.143c-4.273 -3.107 -6.02 -3.5 -12.817 -2.917zM25.92 19.523c-5.247 0.353 -6.437 0.433 -9.417 -1.99L8.927 11.507c-0.77 -0.78 -0.383 -1.753 1.557 -1.947l53.193 -3.887c4.467 -0.39 6.793 1.167 8.54 2.527l9.123 6.61c0.39 0.197 1.36 1.36 0.193 1.36l-54.933 3.307 -0.68 0.047zM19.803 88.3V30.367c0 -2.53 0.777 -3.697 3.103 -3.893L86 22.78c2.14 -0.193 3.107 1.167 3.107 3.693v57.547c0 2.53 -0.39 4.67 -3.883 4.863l-60.377 3.5c-3.493 0.193 -5.043 -0.97 -5.043 -4.083zm59.6 -54.827c0.387 1.75 0 3.5 -1.75 3.7l-2.91 0.577v42.773c-2.527 1.36 -4.853 2.137 -6.797 2.137 -3.107 0 -3.883 -0.973 -6.21 -3.887l-19.03 -29.94v28.967l6.02 1.363s0 3.5 -4.857 3.5l-13.39 0.777c-0.39 -0.78 0 -2.723 1.357 -3.11l3.497 -0.97v-38.3L30.48 40.667c-0.39 -1.75 0.58 -4.277 3.3 -4.473l14.367 -0.967 19.8 30.327v-26.83l-5.047 -0.58c-0.39 -2.143 1.163 -3.7 3.103 -3.89l13.4 -0.78z" fill="#000"/>
            </svg>
        </div>

        <h1>Connect to Notion</h1>
        <p class="subtitle">Choose how to authenticate notion-cli</p>

        <a href="{{.OAuthURL}}" class="oauth-btn">
            <svg class="notion-logo" viewBox="0 0 60 63" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.8,2.7l34.6-2.6c4.2-0.4,5.3-0.1,8,1.8l11.1,7.8c1.8,1.3,2.4,1.7,2.4,3.2v42.7c0,2.7-1,4.3-4.4,4.5l-40.2,2.4c-2.6,0.1-3.8-0.2-5.1-1.9L2.1,50.1c-1.5-2-2.1-3.4-2.1-5.1V7C0,4.8,1,2.9,3.8,2.7z" fill="#FFFFFF"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M38.4,0.1L3.8,2.7C1,2.9,0,4.8,0,7v38c0,1.7,0.6,3.2,2.1,5.1l8.1,10.6c1.3,1.7,2.6,2.1,5.1,1.9l40.2-2.4c3.4-0.2,4.4-1.8,4.4-4.5V12.9c0-1.4-0.5-1.8-2.2-3c-0.1-0.1-0.2-0.1-0.3-0.2L46.4,2C43.8,0,42.7-0.2,38.4,0.1zM16.2,12.2c-3.3,0.2-4,0.3-5.9-1.3L5.6,7.2C5.1,6.7,5.3,6.1,6.6,6l33.3-2.4c2.8-0.2,4.2,0.7,5.3,1.6l5.7,4.1c0.3,0.1,0.9,0.8,0.1,0.8l-34.4,2.1L16.2,12.2zM12.4,55.3V19c0-1.6,0.5-2.3,1.9-2.4l39.5-2.3c1.3-0.1,1.9,0.7,1.9,2.3v36c0,1.6-0.3,2.9-2.4,3l-37.8,2.2C13.4,58,12.4,57.2,12.4,55.3zM49.7,21c0.2,1.1,0,2.2-1.1,2.3l-1.8,0.4v26.8c-1.6,0.9-3,1.3-4.2,1.3c-1.9,0-2.4-0.6-3.9-2.4L26.7,30.6v18.1l3.8,0.9c0,0,0,2.2-3,2.2l-8.4,0.5c-0.2-0.5,0-1.7,0.8-1.9l2.2-0.6v-24l-3-0.3c-0.2-1.1,0.4-2.7,2.1-2.8l9-0.6l12.4,19V24.3l-3.2-0.4c-0.2-1.3,0.7-2.3,1.9-2.4L49.7,21z" fill="#000000"/>
            </svg>
            Continue with Notion
        </a>

        <div class="divider"><span>or</span></div>

        <div class="token-section">
            <h2>Use your own integration token</h2>
            <p>If you have a private integration, paste your token below.</p>
            <input type="password" id="token" class="token-input" placeholder="secret_... or ntn_..." autocomplete="off">
            <button type="button" id="submitToken" class="token-btn">Use this token</button>
            <p id="error" class="error"></p>
        </div>

        <p class="help-link">
            <a href="https://www.notion.so/my-integrations" target="_blank">Create an integration</a> on Notion
        </p>
    </div>

    <script>
        const tokenInput = document.getElementById('token');
        const submitBtn = document.getElementById('submitToken');
        const errorEl = document.getElementById('error');
        const redirectUri = "{{.RedirectURI}}";
        const state = "{{.State}}";

        function showError(msg) {
            errorEl.textContent = msg;
            errorEl.classList.add('show');
        }

        function hideError() {
            errorEl.classList.remove('show');
        }

        function validateToken(token) {
            return token.startsWith('secret_') || token.startsWith('ntn_');
        }

        submitBtn.addEventListener('click', function() {
            hideError();
            const token = tokenInput.value.trim();

            if (!token) {
                showError('Please enter a token');
                return;
            }

            if (!validateToken(token)) {
                showError('Token must start with secret_ or ntn_');
                return;
            }

            if (!redirectUri) {
                showError('No redirect URI - run this from notion-cli');
                return;
            }

            // Redirect to CLI callback with the token
            const url = new URL(redirectUri);
            url.searchParams.set('token', token);
            if (state) {
                url.searchParams.set('state', state);
            }
            window.location.href = url.toString();
        });

        tokenInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                submitBtn.click();
            }
        });

        tokenInput.addEventListener('input', hideError);
    </script>
</body>
</html>
